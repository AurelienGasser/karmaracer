/*! karmaracer 2013-05-08 */
var KarmaHome={};$(function(){KarmaHome.start=function(){function e(){$(".mapLink").click(function(e){return $("#playerNameForm")[0].checkValidity()?(Karma.set("playerName",$("#playerName").val()),Karma.set("map",$(this).text()),!0):($("#playerNameForm").find(":submit").click(),e.preventDefault(),!1)})}function n(n){for(var t=[],a=0;n.length>a;a++){var o=n[a];t.push('<li id="map-',o,'"><a class="mapLink" href="game.'+o+'" >'+o),t.push('</a></br><a class="editLink" href="mm.'+o+'" >edit</a></br><span class="players"/></li>')}$("ul#maps").html(t.join("")),e()}TopBar.setTopBar();var t=window.location.hostname,a=io.connect(t,{secure:!0});a.emit("get_maps",function(e,t){n(t),$("#loadingImage").fadeOut(),$("#mapsContainer").fadeIn(2e3)}),a.on("maps_state",function(e){var n=function(e){return e.name};for(var t in e){var a=e[t],o=_.map(a.players,n).join(", ");o.length>0&&(o="Players : "+o),$("#map-"+a.map+" .players").html(o)}}),$("#playerNameForm").submit(function(){return!1}),$("#playerName").keyup(function(){Karma.set("playerName",$(this).val())})},KarmaHome.start()});