/*! karmaracer 2013-05-09 */
(function(e){"use strict";$(function(){Karma.Home.start()});var t=function(){function t(){$(".mapLink").click(function(e){return $("#playerNameForm")[0].checkValidity()?(Karma.LocalStorage.set("playerName",$("#playerName").val()),Karma.LocalStorage.set("map",$(this).text()),!0):($("#playerNameForm").find(":submit").click(),e.preventDefault(),!1)})}function n(e){for(var n=[],a=0;e.length>a;a++){var o=e[a];n.push('<li id="map-',o,'"><a class="mapLink" href="game.'+o+'" >'+o),n.push('</a></br><a class="editLink" href="mm.'+o+'" >edit</a></br><span class="players"/></li>')}$("ul#maps").html(n.join("")),t()}Karma.TopBar.setTopBar(),new Karma.MiniMap($("body"));var a=window.location.hostname,o=e.connect(a,{secure:!0});o.emit("get_maps",function(e,t){n(t),$("#loadingImage").fadeOut(),$("#mapsContainer").fadeIn(2e3)}),o.on("maps_state",function(e){var t=function(e){return e.name};for(var n in e){var a=e[n],o=_.map(a.players,t).join(", ");o.length>0&&(o="Players : "+o),$("#map-"+a.map+" .players").html(o)}}),$("#playerNameForm").submit(function(){return!1}),$("#playerName").keyup(function(){Karma.LocalStorage.set("playerName",$(this).val())})};Karma.Home={start:t}})(io);