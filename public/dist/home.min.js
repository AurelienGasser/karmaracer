/*! karmaracer 2013-05-08 */
var KarmaHome={};$(function(){KarmaHome.start=function(){function e(){$(".mapLink").click(function(e){return $("#playerNameForm")[0].checkValidity()?(Karma.set("playerName",$("#playerName").val()),Karma.set("map",$(this).text()),!0):($("#playerNameForm").find(":submit").click(),e.preventDefault(),!1)})}function t(t){for(var a=[],n=0;t.length>n;n++){var i=t[n];a.push('<li id="map-',i,'"><a class="mapLink" href="game.'+i+'" >'+i),a.push('</a></br><a class="editLink" href="mm.'+i+'" >edit</a></br><span class="players"/></li>')}$("ul#maps").html(a.join("")),e()}TopBar.setTopBar();var a=window.location.hostname,n=io.connect(a,{secure:!0});n.emit("get_maps",function(e,a){console.log("getmaps",a),t(a),$("#loadingImage").fadeOut(),$("#mapsContainer").fadeIn(2e3)}),n.on("maps_state",function(e){console.log(e);var t=function(e){return e.name};for(var a in e){var n=e[a],i=_.map(n.players,t).join(", ");i.length>0&&(i="Players : "+i),$("#map-"+n.map+" .players").html(i)}}),$("#playerNameForm").submit(function(){return!1}),$("#playerName").keyup(function(){Karma.set("playerName",$(this).val())})},KarmaHome.start()});