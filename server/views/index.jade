html
  head
    title Karma Racer, baby!
    meta(http-equiv='content-type', content='text/html; charset=utf-8')
    meta(name="viewport", content="initial-scale=1.0, maximum-scale=1.0, user-scalable=0.0")
    meta(name="apple-mobile-web-app-capable", content="yes")
    script(type='text/javascript', src='/socket.io/socket.io.js')
    script(type='text/javascript', src='/js/libs/underscore.js')
    script(type='text/javascript', src='/js/libs/modernizr.min.js')
    script(type='text/javascript', src='/js/drawEngine/2DCanvas.js')
    script(type='text/javascript')
      var G_serverHost = '#{server}';
      var G_defaultDrawEngineType = '#{default_draw_engine}';
      var G_MOBILE_DEVICE = false;
      // Google Analytics
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-27170619-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    script(type='text/javascript', src='/js/SocketManager.js')
    script(type='text/javascript', src='/js/chat.js')
    script(type='text/javascript', src='/js/drawEngine/camera.js')
    script(type='text/javascript', src='/js/drawEngine/drawEngineFactory.js')
    script(type='text/javascript', src='/js/keyboard.js')
    script(type='text/javascript', src='/js/game.js')
    script(type='text/javascript', src='/js/startup.js')
    script#shader-fs(type='x-shader/x-fragment').
          #ifdef GL_ES
          precision highp float;
          #endif
          varying vec2 vTextureCoord;
          uniform sampler2D uSampler;
          void main(void) {
           gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
          }

    script#shader-vs(type='x-shader/x-vertex').
          attribute vec3 aVertexPosition;
          attribute vec2 aTextureCoord;
          uniform mat4 uMVMatrix;
          uniform mat4 uPMatrix;
          varying vec2 vTextureCoord;
          void main(void) {
            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
            vTextureCoord = aTextureCoord;
          }

    link(rel='stylesheet', href='/css/race.css')
  body
    div(id='camera-debug')
    canvas#game-canvas
    #right_panel
      #info
        | Tip: Press L or P to zoom
      #player_name_div
        | Player name:
        input#player_name(style='', placeholder='write your name')
      #chat_msgs
        div Welcome to the chat!
        ul
      textarea#chat_input(placeholder='set your message and press enter to send')
    #loadingtext Loading world...
